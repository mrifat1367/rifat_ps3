# Problem set 3

# Question 1

# Installing Package
!pip install pandas
import pandas as pd
import math
import numpy as np

#Reading file
data = pd.read_csv("https://raw.githubusercontent.com/CompTools/Class_Files/master/data/CO-OPS__8729108__wl.csv")
mydata = pd.DataFrame(data)
print(mydata)
x = mydata.iloc[:,[1]]
x.columns = ['Water_Level']
highest = None
print('Before:', highest)
for i in x['Water_Level']:
    if highest is None or highest < i:
        highest = i
    print('Loop:', i, highest)
print('highest:', highest)
mydata.loc[mydata.iloc[:,1] == highest] #Finding the date with highest water level

#Question 2
mydata.iloc[mydata.iloc[:,1].idxmax()]
mydata.iloc[mydata.iloc[:,1].idxmin()]
average = (x.sum()/len(x))
print(average)

#Question 3
df = x
df["change"] = df.diff()
print(df)
y = df.iloc[df["change"].idxmax()]
print(y)
fastest = y[0]
mydata.loc[mydata.iloc[:,1] == fastest]

#Question 4
for j in x["Water_Level"]:
    if 5 < j:
        print("Warning: Water Level is above 5.0 and the reading is:",j)
 df = x
df["change"] = df.diff()
print(df)
for k in df["change"]:
    if 0.25 < k:
        print("Warning: Water is rising very fast and the rate is:",k)
